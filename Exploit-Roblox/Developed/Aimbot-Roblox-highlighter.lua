local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")
local PlayerGui = Players.LocalPlayer:WaitForChild("PlayerGui")
local ScreenGui = PlayerGui:WaitForChild("ScreenGui")

-- Create a function to create a circle
local function createCircle(player)
    local circle = Instance.new("ImageLabel")
    circle.Name = "Circle"
    circle.Image = "rbxassetid://260800170"
    circle.BackgroundTransparency = 1
    circle.Size = UDim2.new(0, 100, 0, 100)
    circle.Position = UDim2.new(0.5, -50, 0.5, -50)
    circle.AnchorPoint = Vector2.new(0.5, 0.5)
    circle.Parent = ScreenGui
    
    -- Create a stroke for the circle
    local stroke = Instance.new("UIStroke")
    stroke.Color = Color3.fromRGB(255, 0, 0)
    stroke.Thickness = 5
    stroke.Parent = circle
    
    -- Create a tween to pulse the circle
    local targetSize = UDim2.new(0, 150, 0, 150)
    local tweenInfo = TweenInfo.new(1, Enum.EasingStyle.Linear, Enum.EasingDirection.Out, -1)
    local tween = TweenService:Create(circle, tweenInfo, {Size = targetSize})
    tween:Play()
    
    -- Store the circle and tween in the player's character
    local character = player.Character or player.CharacterAdded:Wait()
    character:WaitForChild("Humanoid").Died:Connect(function()
        circle:Destroy()
        tween:Cancel()
    end)
    character:SetAttribute("Circle", circle)
    character:SetAttribute("Tween", tween)
end

-- Create a function to select a player and show a stroke around them
local function selectPlayer(player)
    local character = player.Character
    if character then
        local circle = character:GetAttribute("Circle")
        local tween = character:GetAttribute("Tween")
        if circle and tween then
            tween:Cancel()
            circle.ImageColor3 = Color3.fromRGB(255, 0, 0)
            circle.Stroke.Color = Color3.fromRGB(255, 0, 0)
        end
    end
end

-- Connect the createCircle function to all existing players
for _, player in ipairs(Players:GetPlayers()) do
    createCircle(player)
end

-- Connect the createCircle function to new players
Players.PlayerAdded:Connect(createCircle)

-- Connect the selectPlayer function to the local player's mouse click
Screen.MouseGuiButton1Click:Connect(function()
    local mouseTarget = Players.LocalPlayer:GetMouse().Target
    if mouseTarget and mouseTarget:IsA("Model") then
        local player = Players:GetPlayerFromCharacter(mouseTarget.Parent)
        if player then
            selectPlayer(player)
        end
    end
end)
